<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/4.0.0-2/css/bootstrap.min.css} "/>
</head>
<body>

<div th:insert="components/navbar :: navbar"/>

<div class="container">

    <br>
    <div class="month-info">
        <div class="col-xs-12 col-md-6 col-sm-8 col-lg-6 center-block">
            <form th:action="@{/api/user/calendar}"
                  method="get">
                <input type="number" th:name="year" th:value="${localDate.getYear()}" hidden>
                <input type="number" th:name="month" th:value="${localDate.getMonth().getValue()}" hidden>
                <p>
                    <button class="btn btn-default btn-small" type="submit" th:name="arrow" th:value="previous">
                        <svg
                                xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-caret-left-fill" viewBox="0 0 16 16">
                            <path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"/>
                        </svg>
                    </button>
                    <span th:text="${localDate.getMonth().name()}">MONTH</span>

                    <button class="btn btn-default btn-small" type="submit" th:name="arrow" th:value="next">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-caret-right-fill" viewBox="0 0 16 16">
                            <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>
                        </svg>
                    </button>
                </p>
            </form>
        </div>
    </div>

    <br>

    <div class="row">

        <div class="col-3">
            <form th:action="@{/api/user/calendar}" method="get" >

                <h3>Speciality</h3>
                <div th:each="speciality,iter:${specialities}">
                    <div class="form-check">
                        <input th:checked="${specialityList.contains(speciality.getSpeciality())}" th:value="${speciality.getSpeciality()}" name="speciality" class="form-check-input" type="checkbox" value="" id="'speciality' + ${iter}">
                        <label class="form-check-label" th:for="'speciality' + ${iter}" th:text="${speciality.getSpeciality()}"/>
                    </div>
                </div>

                <h3>Course</h3>
                <div th:each="course,iter:${courses}">
                    <div class="form-check">
                        <input th:checked="${courseList.contains(course.getCourse())}" th:value="${course.getCourse()}" name="course" class="form-check-input" type="checkbox" value="" id="'course' + ${iter}">
                        <label class="form-check-label" th:for="'course' + ${iter}" th:text="${course.getCourse()}"/>
                    </div>
                </div>
                <button type="submit" name="action" value="search" class="btn btn-light btn-block"
                        th:text="Search"></button>
            </form>
        </div>
        <div class="col-7">

            <div class="row row-cols-7 days-naming">
                <div class="col"><p>Mon</p></div>
                <div class="col"><p>Tue</p></div>
                <div class="col"><p>Wed</p></div>
                <div class="col"><p>Thu</p></div>
                <div class="col"><p>Fri</p></div>
                <div class="col"><p>Sat</p></div>
                <div class="col"><p>Sun</p></div>
            </div>

            <div class="row row-cols-7 days-list ">
                <div class="col " th:each="d: ${weekDays}">
                    <div th:each="w : ${weeks}" class="" style="height: 70px;">
                        <div th:if="${days.get(w*7+d)} == null">
                            <div>Null</div>
                        </div>
                        <div th:if="${days.get(w*7+d)} != null">
                            <div th:attr="onclick=|showDaySchedule(${days.get(w*7+d)})|">
                                <scan style="font-size: 1.2em;" th:text="${days.get(w*7+d)}"></scan>
                                <p class="mt-1">
                                    <span
                                            th:each="event : ${eventDto.getDaysAtCalendar().get(days.get(w*7+d))}">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"
                                             fill="currentColor"
                                             class="bi bi-circle-fill" viewBox="0 0 8 8">
                                            <circle cx="4" cy="4" r="4"/>
                                        </svg>
                                    </span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="col-2" id="schedule-list">
            <div class="schedule" id="schedule">
                Schedule
            </div>
        </div>

    </div>

</div>

<script th:inline="javascript">

    var userEvent = [[${eventDto.getDaysAtCalendar()}]]

    function showDaySchedule(day) {
        let events = userEvent[day];
        // delete all from div schedule

        var el = document.getElementById('schedule-list');
        while (el.firstChild) el.removeChild(el.firstChild);

        for (let i = 0; i < events.length; i++) {
            /*
            datatime
            lesson
            auditory
             */
            console.log('here')
            $("#schedule-list").append('<div class="border border-dark" id=' + i + '>\n' +
                '                <h6>' + events[i].hours + '  -  ' + events[i].minutes + '</h6>\n' +
                '                <p>' + events[i].name + '</p>\n' +
                '                <p>' + events[i].auditory + '</p>\n' +
                '            </div>');
        }
    }


</script>
<script type="text/javascript">
    $('#example-multiple-selected').multiselect();
</script>

</body>
</html>